"use strict";(self.wpRiseJsonp=self.wpRiseJsonp||[]).push([["recorder"],{15824:(xe,$,g)=>{g.r($),g.d($,{startRecording:()=>Ee});var B=g(11659),it=g(69993),H=g(72581),at=g(17570),D=g(37704),x=g(76033),R=g(58476),ut=g(20358),l=g(16568);const z=new WeakMap;function I(t){return z.has(t)}function ct(t){let n=t;for(;n;){if(!I(n)&&!(0,l.p_)(n))return!1;n=(0,l.$4)(n)}return!0}function y(t){return z.get(t)}function lt(t,n){z.set(t,n)}function O(t,n){const e=t.tagName,s=t.value;if((0,l.Ie)(t,n)){const o=t.type;return e==="INPUT"&&(o==="button"||o==="submit"||o==="reset")?s:!s||e==="OPTION"?void 0:l.o}if(e==="OPTION"||e==="SELECT")return t.value;if(!(e!=="INPUT"&&e!=="TEXTAREA"))return s}const dt=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,ft=/^[A-Za-z]+:|^\/\//,pt=/^["']?data:.*,/i;function ht(t,n){return t.replace(dt,(e,s,o,r,a,i)=>{const u=o||a||i;if(!n||!u||ft.test(u)||pt.test(u))return e;const p=s||r||"";return`url(${p}${mt(u,n)}${p})`})}function mt(t,n){try{return(0,ut.c$)(t,n).href}catch{return t}}const St=/[^a-z1-6-_]/;function U(t){const n=t.toLowerCase().trim();return St.test(n)?"div":n}function G(t,n){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${n}' style='background-color:silver'%3E%3C/svg%3E`}var T=g(32950);const M={FullSnapshot:2,IncrementalSnapshot:3,Meta:4,Focus:6,ViewEnd:7,VisualViewport:8,FrustrationRecord:9},C={Document:0,DocumentType:1,Element:2,Text:3,CDATA:4,DocumentFragment:11},E={Mutation:0,MouseMove:1,MouseInteraction:2,Scroll:3,ViewportResize:4,Input:5,TouchMove:6,MediaInteraction:7,StyleSheetRule:8},v={MouseUp:0,MouseDown:1,Click:2,ContextMenu:3,DblClick:4,Focus:5,Blur:6,TouchStart:7,TouchEnd:9},W={Play:0,Pause:1};function J(t){if(!(t===void 0||t.length===0))return t.map(n=>{const e=n.cssRules||n.rules;return{cssRules:Array.from(e,r=>r.cssText),disabled:n.disabled||void 0,media:n.media.length>0?Array.from(n.media):void 0}})}var gt=g(10805);const yt=1e6;function X(t,n,e,s){if(n===l.$m.HIDDEN)return null;const o=t.getAttribute(e);if(n===l.$m.MASK&&e!==l.NT&&!l.yF.includes(e)&&e!==s.actionNameAttribute){const r=t.tagName;switch(e){case"title":case"alt":case"placeholder":return l.o}if(r==="IMG"&&(e==="src"||e==="srcset")){const a=t;if(a.naturalWidth>0)return G(a.naturalWidth,a.naturalHeight);const{width:i,height:u}=t.getBoundingClientRect();return i>0||u>0?G(i,u):l.eT}if(r==="SOURCE"&&(e==="src"||e==="srcset"))return l.eT;if(r==="A"&&e==="href"||o&&e.startsWith("data-")||r==="IFRAME"&&e==="srcdoc")return l.o}return!o||typeof o!="string"?o:(0,l.ei)(o,yt)}function A(){return{cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}}}function L(t,n,e){t[n].count+=1,t[n].max=Math.max(t[n].max,e),t[n].sum+=e}function Tt(t,n){for(const e of["cssText","serializationDuration"])t[e].count+=n[e].count,t[e].max=Math.max(t[e].max,n[e].max),t[e].sum+=n[e].sum}function Et(t,n,e){if(n===l.$m.HIDDEN)return{};const s={},o=U(t.tagName),r=t.ownerDocument;for(let c=0;c<t.attributes.length;c+=1){const d=t.attributes.item(c).name,S=X(t,n,d,e.configuration);S!==null&&(s[d]=S)}if(t.value&&(o==="textarea"||o==="select"||o==="option"||o==="input")){const c=O(t,n);c!==void 0&&(s.value=c)}if(o==="option"&&n===l.$m.ALLOW){const c=t;c.selected&&(s.selected=c.selected)}if(o==="link"){const c=Array.from(r.styleSheets).find(d=>d.href===t.href),f=P(c);f&&c&&(L(e.serializationContext.serializationStats,"cssText",f.length),s._cssText=f)}if(o==="style"&&t.sheet){const c=P(t.sheet);c&&(L(e.serializationContext.serializationStats,"cssText",c.length),s._cssText=c)}const a=t;if(o==="input"&&(a.type==="radio"||a.type==="checkbox")&&(n===l.$m.ALLOW?s.checked=!!a.checked:(0,l.Ie)(a,n)&&delete s.checked),o==="audio"||o==="video"){const c=t;s.rr_mediaState=c.paused?"paused":"played"}let i,u;const p=e.serializationContext;switch(p.status){case 0:i=Math.round(t.scrollTop),u=Math.round(t.scrollLeft),(i||u)&&p.elementsScrollPositions.set(t,{scrollTop:i,scrollLeft:u});break;case 1:p.elementsScrollPositions.has(t)&&({scrollTop:i,scrollLeft:u}=p.elementsScrollPositions.get(t));break}return u&&(s.rr_scrollLeft=u),i&&(s.rr_scrollTop=i),s}function P(t){if(!t)return null;let n;try{n=t.rules||t.cssRules}catch{}if(!n)return null;const e=Array.from(n,(0,gt.nr)()?vt:Y).join("");return ht(e,t.href)}function vt(t){if(xt(t)&&t.selectorText.includes(":")){const n=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(n,"$1\\$2")}return Y(t)}function Y(t){return Nt(t)&&P(t.styleSheet)||t.cssText}function Nt(t){return"styleSheet"in t}function xt(t){return"selectorText"in t}function V(t,n){const e=wt(t,n);if(!e)return null;const s=y(t)||Mt(),o=e;return o.id=s,lt(t,s),n.serializedNodeIds&&n.serializedNodeIds.add(s),o}let It=1;function Mt(){return It++}function F(t,n){const e=[];return(0,l.wI)(t,s=>{const o=V(s,n);o&&e.push(o)}),e}function wt(t,n){switch(t.nodeType){case t.DOCUMENT_NODE:return Rt(t,n);case t.DOCUMENT_FRAGMENT_NODE:return Ct(t,n);case t.DOCUMENT_TYPE_NODE:return bt(t);case t.ELEMENT_NODE:return Dt(t,n);case t.TEXT_NODE:return zt(t,n);case t.CDATA_SECTION_NODE:return Ot()}}function Rt(t,n){return{type:C.Document,childNodes:F(t,n),adoptedStyleSheets:J(t.adoptedStyleSheets)}}function Ct(t,n){const e=(0,l.p_)(t);return e&&n.serializationContext.shadowRootsController.addShadowRoot(t),{type:C.DocumentFragment,childNodes:F(t,n),isShadowRoot:e,adoptedStyleSheets:e?J(t.adoptedStyleSheets):void 0}}function bt(t){return{type:C.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId}}function Dt(t,n){const e=U(t.tagName),s=Lt(t)||void 0,o=(0,l.jR)((0,l.dT)(t),n.parentNodePrivacyLevel);if(o===l.$m.HIDDEN){const{width:i,height:u}=t.getBoundingClientRect();return{type:C.Element,tagName:e,attributes:{rr_width:`${i}px`,rr_height:`${u}px`,[l.NT]:l.Wd},childNodes:[],isSVG:s}}if(o===l.$m.IGNORE)return;const r=Et(t,o,n);let a=[];if((0,l.wR)(t)&&e!=="style"){let i;n.parentNodePrivacyLevel===o&&n.ignoreWhiteSpace===(e==="head")?i=n:i={...n,parentNodePrivacyLevel:o,ignoreWhiteSpace:e==="head"},a=F(t,i)}return{type:C.Element,tagName:e,attributes:r,childNodes:a,isSVG:s}}function Lt(t){return t.tagName==="svg"||t instanceof SVGElement}function zt(t,n){const e=(0,l.rf)(t,n.ignoreWhiteSpace||!1,n.parentNodePrivacyLevel);if(e!==void 0)return{type:C.Text,textContent:e}}function Ot(){return{type:C.CDATA,textContent:""}}function At(t,n,e){const s=(0,T.nx)(),o=V(t,{serializationContext:e,parentNodePrivacyLevel:n.defaultPrivacyLevel,configuration:n});return L(e.serializationStats,"serializationDuration",(0,T.vk)(s,(0,T.nx)())),o}function _(t){return!!t.changedTouches}function b(t){return t.composed===!0&&(0,l.XS)(t.target)?t.composedPath()[0]:t.target}const j=25;function Pt(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>j||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>j}const Vt=(t,n)=>{const e=window.visualViewport,s={layoutViewportX:t,layoutViewportY:n,visualViewportX:t,visualViewportY:n};if(e)Pt(e)?(s.layoutViewportX=Math.round(t+e.offsetLeft),s.layoutViewportY=Math.round(n+e.offsetTop)):(s.visualViewportX=Math.round(t-e.offsetLeft),s.visualViewportY=Math.round(n-e.offsetTop));else return s;return s},K=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});function N(t,n){return{data:{source:t,...n},type:M.IncrementalSnapshot,timestamp:(0,T.nx)()}}const Ft=50;function kt(t,n){const{throttled:e,cancel:s}=(0,x.n)(r=>{const a=b(r);if(I(a)){const i=Z(r);if(!i)return;const u={id:y(a),timeOffset:0,x:i.x,y:i.y};n(N(_(r)?E.TouchMove:E.MouseMove,{positions:[u]}))}},Ft,{trailing:!1}),{stop:o}=(0,R.l)(t,document,["mousemove","touchmove"],e,{capture:!0,passive:!0});return{stop:()=>{o(),s()}}}function Z(t){let{clientX:n,clientY:e}=_(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:s,visualViewportY:o}=Vt(n,e);n=s,e=o}if(!(!Number.isFinite(n)||!Number.isFinite(e)))return{x:n,y:e}}const Q={pointerup:v.MouseUp,mousedown:v.MouseDown,click:v.Click,contextmenu:v.ContextMenu,dblclick:v.DblClick,focus:v.Focus,blur:v.Blur,touchstart:v.TouchStart,touchend:v.TouchEnd};function $t(t,n,e){const s=o=>{const r=b(o);if((0,l.PJ)(r,t.defaultPrivacyLevel)===l.$m.HIDDEN||!I(r))return;const a=y(r),i=Q[o.type];let u;if(i!==v.Blur&&i!==v.Focus){const c=Z(o);if(!c)return;u={id:a,type:i,x:c.x,y:c.y}}else u={id:a,type:i};const p={id:e.getIdForEvent(o),...N(E.MouseInteraction,u)};n(p)};return(0,R.l)(t,document,Object.keys(Q),s,{capture:!0,passive:!0})}const Bt=100;function q(t,n,e,s=document){const{throttled:o,cancel:r}=(0,x.n)(i=>{const u=b(i);if(!u||(0,l.PJ)(u,t.defaultPrivacyLevel)===l.$m.HIDDEN||!I(u))return;const p=y(u),c=u===document?{scrollTop:(0,l.zL)(),scrollLeft:(0,l.Gn)()}:{scrollTop:Math.round(u.scrollTop),scrollLeft:Math.round(u.scrollLeft)};e.set(u,c),n(N(E.Scroll,{id:p,x:c.scrollLeft,y:c.scrollTop}))},Bt),{stop:a}=(0,R.q)(t,s,"scroll",o,{capture:!0,passive:!0});return{stop:()=>{a(),r()}}}const Ht=200;function Ut(t,n){const e=(0,l.g1)(t).subscribe(s=>{n(N(E.ViewportResize,s))});return{stop:()=>{e.unsubscribe()}}}function Gt(t,n){const e=window.visualViewport;if(!e)return{stop:x.l};const{throttled:s,cancel:o}=(0,x.n)(()=>{n({data:K(e),type:M.VisualViewport,timestamp:(0,T.nx)()})},Ht,{trailing:!1}),{stop:r}=(0,R.l)(t,e,["resize","scroll"],s,{capture:!0,passive:!0});return{stop:()=>{r(),o()}}}function Wt(t,n){return(0,R.l)(t,document,["play","pause"],e=>{const s=b(e);!s||(0,l.PJ)(s,t.defaultPrivacyLevel)===l.$m.HIDDEN||!I(s)||n(N(E.MediaInteraction,{id:y(s),type:e.type==="play"?W.Play:W.Pause}))},{capture:!0,passive:!0})}var w=g(6728);function Jt(t){function n(o,r){o&&I(o.ownerNode)&&r(y(o.ownerNode))}const e=[(0,w.H)(CSSStyleSheet.prototype,"insertRule",({target:o,parameters:[r,a]})=>{n(o,i=>t(N(E.StyleSheetRule,{id:i,adds:[{rule:r,index:a}]})))}),(0,w.H)(CSSStyleSheet.prototype,"deleteRule",({target:o,parameters:[r]})=>{n(o,a=>t(N(E.StyleSheetRule,{id:a,removes:[{index:r}]})))})];typeof CSSGroupingRule<"u"?s(CSSGroupingRule):(s(CSSMediaRule),s(CSSSupportsRule));function s(o){e.push((0,w.H)(o.prototype,"insertRule",({target:r,parameters:[a,i]})=>{n(r.parentStyleSheet,u=>{const p=tt(r);p&&(p.push(i||0),t(N(E.StyleSheetRule,{id:u,adds:[{rule:a,index:p}]})))})}),(0,w.H)(o.prototype,"deleteRule",({target:r,parameters:[a]})=>{n(r.parentStyleSheet,i=>{const u=tt(r);u&&(u.push(a),t(N(E.StyleSheetRule,{id:i,removes:[{index:u}]})))})}))}return{stop:()=>{e.forEach(o=>o.stop())}}}function tt(t){const n=[];let e=t;for(;e.parentRule;){const a=Array.from(e.parentRule.cssRules).indexOf(e);n.unshift(a),e=e.parentRule}if(!e.parentStyleSheet)return;const o=Array.from(e.parentStyleSheet.cssRules).indexOf(e);return n.unshift(o),n}function Xt(t,n){return(0,R.l)(t,window,["focus","blur"],()=>{n({data:{has_focus:document.hasFocus()},type:M.Focus,timestamp:(0,T.nx)()})})}function Yt(t,n,e){const s=t.subscribe(12,o=>{var r,a;o.rawRumEvent.type===l.bb.ACTION&&o.rawRumEvent.action.type===l.X2.CLICK&&(!((a=(r=o.rawRumEvent.action.frustration)===null||r===void 0?void 0:r.type)===null||a===void 0)&&a.length)&&"events"in o.domainContext&&o.domainContext.events&&o.domainContext.events.length&&n({timestamp:o.rawRumEvent.date,type:M.FrustrationRecord,data:{frustrationTypes:o.rawRumEvent.action.frustration.type,recordIds:o.domainContext.events.map(i=>e.getIdForEvent(i))}})});return{stop:()=>{s.unsubscribe()}}}function _t(t,n){const e=t.subscribe(5,()=>{n({timestamp:(0,T.nx)(),type:M.ViewEnd})});return{stop:()=>{e.unsubscribe()}}}function et(t,n,e=document){const s=t.defaultPrivacyLevel,o=new WeakMap,r=e!==document,{stop:a}=(0,R.l)(t,e,r?["change"]:["input","change"],c=>{const f=b(c);(f instanceof HTMLInputElement||f instanceof HTMLTextAreaElement||f instanceof HTMLSelectElement)&&u(f)},{capture:!0,passive:!0});let i;if(r)i=x.l;else{const c=[(0,w.t)(HTMLInputElement.prototype,"value",u),(0,w.t)(HTMLInputElement.prototype,"checked",u),(0,w.t)(HTMLSelectElement.prototype,"value",u),(0,w.t)(HTMLTextAreaElement.prototype,"value",u),(0,w.t)(HTMLSelectElement.prototype,"selectedIndex",u)];i=()=>{c.forEach(f=>f.stop())}}return{stop:()=>{i(),a()}};function u(c){const f=(0,l.PJ)(c,s);if(f===l.$m.HIDDEN)return;const d=c.type;let S;if(d==="radio"||d==="checkbox"){if((0,l.Ie)(c,f))return;S={isChecked:c.checked}}else{const h=O(c,f);if(h===void 0)return;S={text:h}}p(c,S);const m=c.name;d==="radio"&&m&&c.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(m)}"]`).forEach(h=>{h!==c&&p(h,{isChecked:!1})})}function p(c,f){if(!I(c))return;const d=o.get(c);(!d||d.text!==f.text||d.isChecked!==f.isChecked)&&(o.set(c,f),n(N(E.Input,{id:y(c),...f})))}}var jt=g(63960),Kt=g(45906);const Zt=100,Qt=16;function qt(t){let n=x.l,e=[];function s(){n(),t(e),e=[]}const{throttled:o,cancel:r}=(0,x.n)(s,Qt,{leading:!1});return{addMutations:a=>{e.length===0&&(n=(0,Kt.BB)(o,{timeout:Zt})),e.push(...a)},flush:s,stop:()=>{n(),r()}}}function nt(t,n,e,s){const o=(0,l.W3)();if(!o)return{stop:x.l,flush:x.l};const r=qt(i=>{te(i.concat(a.takeRecords()),t,n,e)}),a=new o((0,jt.dm)(r.addMutations));return a.observe(s,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{a.disconnect(),r.stop()},flush:()=>{r.flush()}}}function te(t,n,e,s){const o=new Map;t.filter(d=>d.type==="childList").forEach(d=>{d.removedNodes.forEach(S=>{ot(S,s.removeShadowRoot)})});const r=t.filter(d=>d.target.isConnected&&ct(d.target)&&(0,l.PJ)(d.target,e.defaultPrivacyLevel,o)!==l.$m.HIDDEN),a=A(),{adds:i,removes:u,hasBeenSerialized:p}=ee(r.filter(d=>d.type==="childList"),e,a,s,o),c=ne(r.filter(d=>d.type==="characterData"&&!p(d.target)),e,o),f=oe(r.filter(d=>d.type==="attributes"&&!p(d.target)),e,o);!c.length&&!f.length&&!u.length&&!i.length||n(N(E.Mutation,{adds:i,removes:u,texts:c,attributes:f}),a)}function ee(t,n,e,s,o){const r=new Set,a=new Map;for(const m of t)m.addedNodes.forEach(h=>{r.add(h)}),m.removedNodes.forEach(h=>{r.has(h)||a.set(h,m.target),r.delete(h)});const i=Array.from(r);se(i);const u=new Set,p={status:2,serializationStats:e,shadowRootsController:s},c=[];for(const m of i){if(d(m))continue;const h=(0,l.PJ)(m.parentNode,n.defaultPrivacyLevel,o);if(h===l.$m.HIDDEN||h===l.$m.IGNORE)continue;const ve=(0,T.nx)(),rt=V(m,{serializedNodeIds:u,parentNodePrivacyLevel:h,serializationContext:p,configuration:n});if(L(e,"serializationDuration",(0,T.vk)(ve,(0,T.nx)())),!rt)continue;const Ne=(0,l.$4)(m);c.push({nextId:S(m),parentId:y(Ne),node:rt})}const f=[];return a.forEach((m,h)=>{I(h)&&f.push({parentId:y(m),id:y(h)})}),{adds:c,removes:f,hasBeenSerialized:d};function d(m){return I(m)&&u.has(y(m))}function S(m){let h=m.nextSibling;for(;h;){if(I(h))return y(h);h=h.nextSibling}return null}}function ne(t,n,e){var s;const o=[],r=new Set,a=t.filter(i=>r.has(i.target)?!1:(r.add(i.target),!0));for(const i of a){if(i.target.textContent===i.oldValue)continue;const p=(0,l.PJ)((0,l.$4)(i.target),n.defaultPrivacyLevel,e);p===l.$m.HIDDEN||p===l.$m.IGNORE||o.push({id:y(i.target),value:(s=(0,l.rf)(i.target,!1,p))!==null&&s!==void 0?s:null})}return o}function oe(t,n,e){const s=[],o=new Map,r=t.filter(i=>{const u=o.get(i.target);return u&&u.has(i.attributeName)?!1:(u?u.add(i.attributeName):o.set(i.target,new Set([i.attributeName])),!0)}),a=new Map;for(const i of r){if(i.target.getAttribute(i.attributeName)===i.oldValue)continue;const p=(0,l.PJ)(i.target,n.defaultPrivacyLevel,e),c=X(i.target,p,i.attributeName,n);let f;if(i.attributeName==="value"){const S=O(i.target,p);if(S===void 0)continue;f=S}else typeof c=="string"?f=c:f=null;let d=a.get(i.target);d||(d={id:y(i.target),attributes:{}},s.push(d),a.set(i.target,d)),d.attributes[i.attributeName]=f}return s}function se(t){t.sort((n,e)=>{const s=n.compareDocumentPosition(e);return s&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:s&Node.DOCUMENT_POSITION_CONTAINS||s&Node.DOCUMENT_POSITION_FOLLOWING?1:s&Node.DOCUMENT_POSITION_PRECEDING?-1:0})}function ot(t,n){(0,l.XS)(t)&&n(t.shadowRoot),(0,l.wI)(t,e=>ot(e,n))}function re(){const t=new WeakMap;return{set(n,e){n===document&&!document.scrollingElement||t.set(n===document?document.scrollingElement:n,e)},get(n){return t.get(n)},has(n){return t.has(n)}}}const ie=(t,n,e)=>{const s=new Map,o={addShadowRoot:r=>{if(s.has(r))return;const a=nt(n,t,o,r),i=et(t,n,r),u=q(t,n,e,r);s.set(r,{flush:()=>a.flush(),stop:()=>{a.stop(),i.stop(),u.stop()}})},removeShadowRoot:r=>{const a=s.get(r);a&&(a.stop(),s.delete(r))},stop:()=>{s.forEach(({stop:r})=>r())},flush:()=>{s.forEach(({flush:r})=>r())}};return o};function ae(t,n,e,s,o,r){const a=(u,p)=>{const{width:c,height:f}=(0,l.pB)();r({data:{height:f,href:window.location.href,width:c},type:M.Meta,timestamp:u}),r({data:{has_focus:document.hasFocus()},type:M.Focus,timestamp:u});const d=A();r({data:{node:At(document,s,{status:p,elementsScrollPositions:t,serializationStats:d,shadowRootsController:n}),initialOffset:{left:(0,l.Gn)(),top:(0,l.zL)()}},type:M.FullSnapshot,timestamp:u},d),window.visualViewport&&r({data:K(window.visualViewport),type:M.VisualViewport,timestamp:u})};a((0,T.nx)(),0);const{unsubscribe:i}=e.subscribe(2,u=>{o(),a(u.startClocks.timeStamp,1)});return{stop:i}}function ue(){const t=new WeakMap;let n=1;return{getIdForEvent(e){return t.has(e)||t.set(e,n++),t.get(e)}}}function ce(t){const{emit:n,configuration:e,lifeCycle:s}=t;if(!n)throw new Error("emit function is required");const o=(d,S)=>{n(d,S),(0,at.b)("record",{record:d});const m=t.viewHistory.findView();D.$1(m.id)},r=re(),a=ie(e,o,r),{stop:i}=ae(r,a,s,e,u,o);function u(){a.flush(),c.flush()}const p=ue(),c=nt(o,e,a,document),f=[c,kt(e,o),$t(e,o,p),q(e,o,r,document),Ut(e,o),et(e,o),Wt(e,o),Jt(o),Xt(e,o),Gt(e,o),Yt(s,o,p),_t(s,d=>{u(),o(d)})];return{stop:()=>{a.stop(),f.forEach(d=>d.stop()),i()},flushMutations:u,shadowRootsController:a}}var le=g(61884),st=g(53543);function de(t,n,e,s){const o=new FormData;o.append("segment",new Blob([t],{type:"application/octet-stream"}),`${n.session.id}-${n.start}`);const r={raw_segment_size:s,compressed_segment_size:t.byteLength,...n},a=JSON.stringify(r);return o.append("event",new Blob([a],{type:"application/json"})),{data:o,bytesCount:t.byteLength,cssText:e.cssText,isFullSnapshot:n.index_in_view===0,rawSize:s,recordCount:n.records_count,serializationDuration:e.serializationDuration}}function fe({context:t,creationReason:n,encoder:e}){let s=0;const o=t.view.id,r=D.K_(o),a={start:1/0,end:-1/0,creation_reason:n,records_count:0,has_full_snapshot:!1,index_in_view:r,source:"browser",...t},i=A();D.H5(o);function u(c,f,d){a.start=Math.min(a.start,c.timestamp),a.end=Math.max(a.end,c.timestamp),a.records_count+=1,a.has_full_snapshot||(a.has_full_snapshot=c.type===M.FullSnapshot),f&&Tt(i,f);const S=e.isEmpty?'{"records":[':",";e.write(S+JSON.stringify(c),m=>{s+=m,d(s)})}function p(c){if(e.isEmpty)throw new Error("Empty segment flushed");e.write(`],${JSON.stringify(a).slice(1)}
`),e.finish(f=>{D.L7(a.view.id,f.rawBytesCount),c(a,i,f)})}return{addRecord:u,flush:p}}const pe=5*T.OY;let k=6e4;function he(t,n,e,s,o,r){return me(t,()=>Se(n.applicationId,e,s),o,r)}function me(t,n,e,s){let o={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:r}=t.subscribe(2,()=>{i("view_change")}),{unsubscribe:a}=t.subscribe(11,u=>{i(u.reason)});function i(u){o.status===1&&(o.segment.flush((p,c,f)=>{const d=de(f.output,p,c,f.rawBytesCount);(0,le.Kp)(u)?e.sendOnExit(d):e.send(d)}),(0,st.DJ)(o.expirationTimeoutId)),u!=="stop"?o={status:0,nextSegmentCreationReason:u}:o={status:2}}return{addRecord:(u,p)=>{if(o.status!==2){if(o.status===0){const c=n();if(!c)return;o={status:1,segment:fe({encoder:s,context:c,creationReason:o.nextSegmentCreationReason}),expirationTimeoutId:(0,st.wg)(()=>{i("segment_duration_limit")},pe)}}o.segment.addRecord(u,p,c=>{c>k&&i("segment_bytes_limit")})}},stop:()=>{i("stop"),r(),a()}}}function Se(t,n,e){const s=n.findTrackedSession(),o=e.findView();if(!(!s||!o))return{application:{id:t},session:{id:s.id},view:{id:o.id}}}function Ie(t=6e4){k=t}function ge(t,n){if(!t.metricsEnabled)return{stop:x.l};const{unsubscribe:e}=n.subscribe(s=>{if(s.type==="failure"||s.type==="queue-full"||s.type==="success"&&s.payload.isFullSnapshot){const o=ye(s.type,s.bandwidth,s.payload);(0,B.Gk)("Segment network request metrics",{metrics:o})}});return{stop:e}}function ye(t,n,e){return{cssText:{count:e.cssText.count,max:e.cssText.max,sum:e.cssText.sum},isFullSnapshot:e.isFullSnapshot,ongoingRequests:{count:n.ongoingRequestCount,totalSize:n.ongoingByteCount},recordCount:e.recordCount,result:t,serializationDuration:{count:e.serializationDuration.count,max:e.serializationDuration.max,sum:e.serializationDuration.sum},size:{compressed:e.bytesCount,raw:e.rawSize}}}function Te(t){const n=(0,H.Y9)();return{addRecord:e=>{const s=t.findView();n.send("record",e,s.id)}}}function Ee(t,n,e,s,o,r,a){const i=[],u=d=>{t.notify(14,{error:d}),(0,B.A2)("Error reported to customer",{"error.message":d.message})},p=a||(0,it.sA)([n.sessionReplayEndpointBuilder],k,u);let c;if((0,H.d0)())({addRecord:c}=Te(s));else{const d=he(t,n,e,s,p,o);c=d.addRecord,i.push(d.stop);const S=ge(r,p.observable);i.push(S.stop)}const{stop:f}=ce({emit:c,configuration:n,lifeCycle:t,viewHistory:s});return i.push(f),{stop:()=>{i.forEach(d=>d())}}}}}]);
